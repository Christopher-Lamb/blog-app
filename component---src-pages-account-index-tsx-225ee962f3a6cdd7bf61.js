"use strict";(self.webpackChunkmy_gatsby_site=self.webpackChunkmy_gatsby_site||[]).push([[956],{4597:function(t,e,a){a.r(e),a.d(e,{Head:function(){return w},default:function(){return g}});var r=a(5785),n=a(7294),l=a(5953),s=a(1902),o=a(4397);function i(t,e){const a=[],r=[];return t.forEach((t=>{t.blogPreview.title.toLowerCase().includes(e.toLowerCase())?a.push(t):r.push(t)})),a.sort(((t,a)=>{const r=t.blogPreview.title.toLowerCase(),n=a.blogPreview.title.toLowerCase();return r.startsWith(e.toLowerCase())&&!n.startsWith(e.toLowerCase())?-1:!r.startsWith(e.toLowerCase())&&n.startsWith(e.toLowerCase())?1:r.indexOf(e.toLowerCase())-n.indexOf(e.toLowerCase())})),a.concat(r)}function u(t,e){return t.sort(((t,a)=>{const r=new Date(t[e]||0);return new Date(a[e]||0).getTime()-r.getTime()}))}const c=()=>{const{0:t,1:e}=(0,n.useState)(!0),{0:a,1:c}=(0,n.useState)([]),{0:g,1:w}=(0,n.useState)([]),{0:h,1:m}=(0,n.useState)("lastUpdated"),{0:p,1:b}=(0,n.useState)("lastPublished"),{userObj:y}=(0,o.S)();(0,n.useEffect)((()=>{(async()=>{try{let t=u(await(0,s.ny)(),"updatedAt");c(t);let e=u(await(0,s.Y7)(),"lastUpdatedDate");w(e)}catch(t){}})()}),[]);const f=t=>{let e=[];m(t),e=u(a,"lastUpdated"===t?"updatedAt":"createdAt"),c((()=>(0,r.Z)(e)))},E=t=>{let e=[];b(t),"latestPublish"===t?e=u(g,"lastUpdatedDate"):"newest"===t&&(e=u(g,"firstPublishedDate")),w((()=>(0,r.Z)(e)))};return n.createElement("main",null,n.createElement(l.wp,null),n.createElement(l.uI,null),n.createElement(l.KY,{onChange:async t=>{e(t)}}),t?n.createElement(n.Fragment,null,n.createElement("div",{className:"mx-auto max-w-five px-4 xl:px-0 flex flex-col md:flex-row gap-2xsmall"},n.createElement(d,{onClick:async()=>{const t=await(0,s.Vh)();c((e=>[{author:null==y?void 0:y.username,slug:t.slug,blogPreview:t.blogPreview}].concat((0,r.Z)(e))))}},"Create Blog"),n.createElement(l.A1,{onChange:f,initialSortType:h},n.createElement("option",{value:"lastUpdated"},"Last Updated"),n.createElement("option",{value:"lastCreated"},"Last Created")),n.createElement("div",{className:"max-w-three w-full mt-3"},n.createElement(l.E1,{type:"medium",onChange:t=>{if(""===t)f(h);else{const e=i(a,t);c((()=>(0,r.Z)(e)))}}}))),n.createElement(l.W2,{className:"gap-xsmall mt-med container mx-auto px-4 md:px-0 xl:max-w-five"},a.map(((t,e)=>n.createElement(l.df,{key:t.slug,isPublished:t.isPublished,onPublish:()=>(async t=>{try{if(await(0,s.VN)(t),!g.some((e=>e.slug===t))){const e=a.find((e=>e.slug===t));if(e){e.isPublished=!0,e.firstPublishedDate||(e.firstPublishedDate=new Date),e.lastUpdatedDate=new Date;const n=a.map((a=>a.slug===t?e:a));c(n),w((t=>[e].concat((0,r.Z)(t))))}else{const e=g.map((e=>e.slug===t?{...e,lastUpdatedDate:new Date}:e));w((()=>(0,r.Z)(e)))}}}catch(e){}})(t.slug),onDelete:()=>{(async t=>{const e=a.filter((e=>e.slug!==t)),r=g.filter((e=>e.slug!==t));c(e),w(r),await(0,s.X4)(t)})(t.slug)}},n.createElement(l.IN,t)))))):n.createElement("div",{className:"mx-auto max-w-five px-4 grid xl:px-0 flex gap-2xsmall"},n.createElement("div",{className:"flex gap-2xsmall"},n.createElement(l.A1,{onChange:E,initialSortType:p},n.createElement("option",{value:"latestPublish"},"Latest Publish"),n.createElement("option",{value:"newest"},"Newest")),n.createElement("div",{className:"max-w-three w-full mt-3"},n.createElement(l.E1,{type:"medium",onChange:t=>{if(""===t)E(p);else{const e=i(g,t);w((()=>(0,r.Z)(e)))}}}))),n.createElement(l.W2,{className:"gap-xsmall mt-med container mx-auto px-4 md:px-0 xl:max-w-five"},g.map((t=>n.createElement(l.NB,{key:t.slug,onUnpublish:()=>(async t=>{const e=g.filter((e=>e.slug!==t)),r=a.map((e=>e.slug===t?{...e,isPublished:!1}:e));w(e),c(r),await(0,s.yr)(t)})(t.slug)},n.createElement(l.IN,t)))))),n.createElement(l.$_,{className:"mt-four"}))},d=t=>{const{children:e,...a}=t;return n.createElement("button",Object.assign({className:"text-med px-xsmall py-2xsmall primary"},a),e)};var g=t=>n.createElement(l._j,Object.assign({WrappedComponent:c},t));const w=()=>n.createElement("title",null,"Home")},1902:function(t,e,a){a.d(e,{B8:function(){return o},BV:function(){return p},Op:function(){return h},V8:function(){return b},VN:function(){return c},Vh:function(){return l},Wb:function(){return m},X4:function(){return g},Y7:function(){return d},aq:function(){return i},k5:function(){return u},ny:function(){return s},yr:function(){return w}});var r=a(1257);const n="https://krispywebsites.com/api",l=async()=>{try{return(await r.Z.post(n+"/blog/",{},{withCredentials:!0})).data}catch(t){throw console.error(t),new Error("Error during Blog Creation")}},s=async()=>{try{return(await r.Z.post(n+"/blog/byAuthor",{},{withCredentials:!0})).data}catch(t){throw new Error("Couldnt Get Authors Blogs")}},o=async t=>{try{return(await r.Z.post(n+"/blog/draftBySlug",{slug:t},{withCredentials:!0})).data}catch(e){throw new Error("Couldnt Get Authors Blogs")}},i=async(t,e)=>{try{return(await r.Z.patch(n+"/blog/draftBySlug",{slug:t,draft:e},{withCredentials:!0})).data}catch(a){throw new Error("Oopsie Blog Didnt update something went wrong >:(")}},u=async(t,e)=>{try{return(await r.Z.patch(n+"/blog/slugBySlug",{oldSlug:t,newSlug:e},{withCredentials:!0})).data}catch(a){throw new Error("Oopsie Slug Didnt update something went wrong >:(")}},c=async t=>{try{return(await r.Z.post(n+"/blog/publish-blog",{slug:t},{withCredentials:!0})).data}catch(e){throw new Error("Couldnt get blog post...XD")}},d=async()=>{try{return(await r.Z.post(n+"/blog/published-by-author",{},{withCredentials:!0})).data}catch(t){throw new Error("Couldnt get blog post...XD")}},g=async t=>{try{return(await r.Z.post(n+"/blog/deleteBySlug",{slug:t},{withCredentials:!0})).data}catch(e){throw new Error("Couldnt delete blog..XD")}},w=async t=>{try{return(await r.Z.post(n+"/blog/unpublish-blog",{slug:t},{withCredentials:!0})).data}catch(e){throw new Error("Couldnt get blog post...XD")}},h=async(t,e)=>{try{return(await r.Z.post(n+"/blog/get-published-blogs",{pageNumber:t,limit:e},{withCredentials:!0})).data}catch(a){throw new Error("Couldnt get published blogs...XD")}},m=async t=>{try{return(await r.Z.post(n+"/blog/get-page-amount",{limit:t},{withCredentials:!0})).data}catch(e){throw new Error("Couldnt get published blogs...XD")}},p=async(t,e,a)=>{try{return(await r.Z.post(n+"/blog/search-published-blogs",{page:t,limit:a,searchQuery:e},{withCredentials:!0})).data}catch(l){throw new Error("Couldnt Search published Blogs...XD")}},b=async t=>{try{return(await r.Z.post(n+"/blog/get-published-by-slug",{slug:t},{withCredentials:!0})).data}catch(e){throw new Error("Couldnt Search published Blogs...XD")}}}}]);
//# sourceMappingURL=component---src-pages-account-index-tsx-225ee962f3a6cdd7bf61.js.map