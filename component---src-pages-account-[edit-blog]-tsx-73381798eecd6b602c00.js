"use strict";(self.webpackChunkmy_gatsby_site=self.webpackChunkmy_gatsby_site||[]).push([[385],{144:function(e,t,a){a.r(t),a.d(t,{Head:function(){return y}});var n=a(5785),l=a(7294),r=a(5953),s=a(5948),c=a(80),i=a(2091),m=a(2649),o=a(7164),d=a(4303),p=a(1902),u=a(4397),g=a(4593);const h={h2:"subheading",p:"paragraph"},f={title:"h1",subtitle:"span",paragraph:"p",subheading:"h2",image:"img"},E=e=>{var t;const{0:a,1:c}=(0,l.useState)({}),{0:i,1:E}=(0,l.useState)([]),{userObj:y}=(0,u.S)(),w=(0,l.useRef)({}),x="undefined"!=typeof window&&window.location.pathname.split("/").filter((e=>e)).pop()||"",{0:v,1:N}=(0,l.useState)(x);(0,l.useEffect)((()=>{(async()=>{const{draft:e}=await(0,p.B8)(x),t=e.filter((e=>void 0!==e.position)).sort(((e,t)=>e.position-t.position)).map((e=>e._id));E(t);let a={};e.forEach((e=>{["title","subtitle","description","thumbnail"].includes(e.type)?a[e.type]=e:a[e._id]=e})),c(a),w.current=a})()}),[]);const k=e=>{const t=JSON.parse(JSON.stringify(a));delete t[e],c(t),E((t=>t.filter((t=>t!==e))))},C=(e,t)=>{c((a=>({...a,[e]:{...a[e],content:t}})))},S=(e,t,a)=>{let n=a?{src:t,content:a}:{src:t,content:""};c((t=>({...t,[e]:{...t[e],...n}})))},_=(new Date).toLocaleDateString("en-US",{weekday:"short",year:"numeric",month:"short",day:"numeric"});return l.createElement("main",null,l.createElement(g.q,null,l.createElement("title",null,(0,d.q_)((null===(t=a.title)||void 0===t?void 0:t.content)||"")," The Public Post")),l.createElement(r.wp,null),l.createElement(s.Z5,{onDragEnd:e=>{const t=(0,m.Z)(i,e);t&&E(t)}},l.createElement("div",{className:"flex justify-end mx-auto max-w-five"},l.createElement("div",{className:"flex flex-col md:flex-row items-center gap-small"},l.createElement(r.k$,{onSave:async()=>{let e=JSON.parse(JSON.stringify(a));i.forEach(((t,a)=>{e[t]={...e[t],position:a}}));const t=Object.keys(e).map((t=>{const{_id:a,...n}=e[t];return"blogitem"===a.split("-")[0]?n:e[t]}));if((await(0,p.aq)(x,t)).forEach((e=>{if("image"===e.type){const t=i[e.position];c((a=>({...a,[t]:{...a[t],src:e.src}})))}else"thumbnail"===e.type&&c((t=>({...t,thumbnail:{...t.thumbnail,src:e.src}})))})),x!==v){const e=await(0,p.k5)(x,v);"undefined"!=typeof window&&window.location.replace("/account/"+e)}}}))),l.createElement("div",{className:"flex flex-col items-start blog mt-med container mx-auto px-4 md:px-0 max-w-four min-h-[80vh]"},a.title&&l.createElement(l.Fragment,null,l.createElement(r.pk,{title:"Url, Description, and Thumbnail"},l.createElement("div",{className:"grid w-full gap-3xsmall max-w-four p-4"},l.createElement("div",{className:"grid"},l.createElement("label",{className:"text-med w-fit",style:{borderBottom:"2px solid rgba(0,0,0,.2)"}},"Slug or Url Path"),l.createElement("input",{className:"p-3xsmall w-full text-small18 border",onChange:e=>{let t=e.target.value;t=t.replace(/(\s+)|(-+)/g,"-"),t=t.replace(/[^a-zA-Z0-9-]/g,""),t=t.replace(/(\s+)|(-+)/g,"-"),t=t.replace(/^[-]+|[-]+$/g,""),t=t.slice(0,70).toLowerCase(),N(t)},defaultValue:v}),l.createElement("span",{className:"p-3xsmall"},"slug preview: /",v,"/")),l.createElement("div",{className:"grid"},l.createElement("label",{className:"text-med w-fit",style:{borderBottom:"2px solid rgba(0,0,0,.2)"}},"Brief Description"),l.createElement("textarea",{maxLength:300,onChange:e=>C("description",e.target.value),className:"h-[100px] resize-none w-full p-3xsmall border",defaultValue:w.current.description.content})),l.createElement("div",{className:"max-w-three w-full"},l.createElement("label",{className:"text-med"},"Thumbnail:"),l.createElement(r.pl,{handleChange:e=>S("thumbnail",e),src:a.thumbnail.src})))),l.createElement(r.g0,{className:"w-full ",placeholder:"Headline",primaryElement:"h1",secondaryElement:"none",onChange:e=>C("title",e),content:w.current.title.content}),l.createElement(r.g0,{className:"w-full",placeholder:"Subheadline",primaryElement:"span",id:"subtitle",secondaryElement:"none",onChange:e=>C("subtitle",e),content:w.current.subtitle.content}),l.createElement("span",{id:"author"},"Written by ",null==y?void 0:y.username),l.createElement("span",{id:"date"},_)),l.createElement(s.bK,{droppableId:"main"},((e,t)=>l.createElement("div",Object.assign({className:"borderl w-full",ref:e.innerRef},e.droppableProps),i.map(((e,t)=>l.createElement(b,{id:e,index:t,key:e,type:a[e].type,onDelete:k},"image"===a[e].type?l.createElement(r.n7,{index:t,handleChange:(t,a)=>S(e,t,a),content:a[e].content,src:a[e].src}):l.createElement(r.g0,{className:"w-full h-fit",primaryElement:f[a[e].type],secondaryElement:"paragraph"===a[e].type?"p":"none",onChange:t=>{C(e,t)},placeholder:h[a[e].type],content:w.current[e].content})))),e.placeholder))),l.createElement(r.Y$,{className:"mt-3xsmall",onClick:e=>{const t="blogitem-"+(0,o.Z)();E((e=>[].concat((0,n.Z)(e),[t]))),"img"===e?c((e=>({...e,[t]:{_id:t,type:"image",src:"",content:"<label></label>"}}))):"title"===e||(w.current={...w.current,[t]:{_id:t,type:e,content:""}},c((a=>({...a,[t]:{_id:t,type:h[e],content:""}}))))}}))))},b=e=>{let{id:t,index:a,children:n,type:r,onDelete:m,className:o}=e,d="0";switch(r){case"image":d="my-3";break;case"subheading":d="mb-[0.125rem] mt-2";break;case"paragraph":d="mb-2"}return l.createElement(s._l,{draggableId:t,index:a},(e=>l.createElement("div",Object.assign({ref:e.innerRef},e.draggableProps,{className:"flex h-auto relative gap-2s "+d}),n,"image"===r?l.createElement("div",{className:"absolute rights-0 flex"},l.createElement("div",Object.assign({className:"relative primary h-8 w-8 shrink-0 rounded"},e.dragHandleProps),l.createElement(c.fE1,{size:"2rem"})),l.createElement("button",{onClick:()=>m(t),className:"relative shrink-0 accent h-8 w-8 flex items-center justify-center rounded"},l.createElement(i.Xm5,{size:"1rem"}))):l.createElement(l.Fragment,null,l.createElement("div",Object.assign({className:"relative primary h-8 w-8 shrink-0 rounded"},e.dragHandleProps),l.createElement(c.fE1,{size:"2rem"})),l.createElement("button",{onClick:()=>m(t),className:"relative shrink-0 accent h-8 w-8 flex items-center justify-center rounded"},l.createElement(i.Xm5,{size:"1rem"}))))))};t.default=e=>l.createElement(r._j,Object.assign({WrappedComponent:E},e));const y=()=>l.createElement("title",null,"Create Blog")}}]);
//# sourceMappingURL=component---src-pages-account-[edit-blog]-tsx-73381798eecd6b602c00.js.map